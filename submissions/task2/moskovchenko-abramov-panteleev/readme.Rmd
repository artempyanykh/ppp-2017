
Чтение исходных данных
```{r}
data <- read.csv("production-data.csv", header = TRUE)
data
```
Сумма произведенного оружия по месяцам компании Harpy
```{r}
sum_produced_harpy <- c(0,0,0,0,0,0)

k = 1
for (i in 1:6){
  while ( data$supplier[k] == "harpy.co"){
    if (data$production.date[k] == i){
      sum_produced_harpy[i] = sum_produced_harpy[i] + data$produced[k]}
    k= k +1
  }
  k = 1
}
sum_produced_harpy

```
Доля сломанных мечей за каждый месяц использования, в зависимости от месяца выпуска; А так же среднее значение на каждый из месяцев использования Harpy:
```{r}
matrix_defects_harpy <- matrix(0,6,7)
for (i in 1:6){
  for (j in 1:7){
    while ( data$supplier[k] == "harpy.co"){
      if (data$production.date[k] == i && data$report.date[k] == j){
        matrix_defects_harpy[i,j-i+1] = matrix_defects_harpy[i,j-i+1] + data$defects[k]
      } 
      k = k + 1
    }
    k = 1
    matrix_defects_harpy[i,j-i+1]=matrix_defects_harpy[i,j-i+1]/sum_produced_harpy[i]
  }
}
for (i in 1:6){
  for (j in 2:7){
    if (matrix_defects_harpy[i,j] == 0) matrix_defects_harpy[i,j] = NA
  }
}
matrix_defects_harpy 

array_mean_defects_harpy <- c(0,0,0,0,0,0,0)
for (i in 2:7){
  array_mean_defects_harpy[i]=mean(matrix_defects_harpy[,i], na.rm = TRUE)
  array_mean_defects_harpy[i]=array_mean_defects_harpy[i]+array_mean_defects_harpy[i-1]
}
array_mean_defects_harpy
```
Сумма произведенного оружия по месяцам компании Westeros
```{r}
sum_produced_westeros <- c(0,0,0,0,0,0)

k = 1352
for (i in 1:6){
  while (k<=2700){
    if (data$production.date[k] == i){
      sum_produced_westeros[i] = sum_produced_westeros[i] + data$produced[k]}
    k= k +1
  }
  k = 1352
}
sum_produced_westeros
```
Доля сломанных мечей за каждый месяц использования, в зависимости от месяца выпуска; А так же среднее значение на каждый из месяцев использования  Westeros:
```{r}
matrix_defects_westeros <- matrix(0,6,7)
k = 1352
for (i in 1:6){
  for (j in 1:7){
    while ( k<=2700){
      if (data$production.date[k] == i && data$report.date[k] == j){
        matrix_defects_westeros[i,j-i+1] = matrix_defects_westeros[i,j-i+1] + data$defects[k]
      } 
      k = k + 1
    }
    k = 1352
    matrix_defects_westeros[i,j-i+1]=matrix_defects_westeros[i,j-i+1]/sum_produced_westeros[i]
  }
}
for (i in 1:6){
  for (j in 2:7){
    if (matrix_defects_westeros[i,j] == 0) matrix_defects_westeros[i,j] = NA
  }
}
matrix_defects_westeros

array_mean_defects_westeros <- c(0,0,0,0,0,0,0)
for (i in 2:7){
  array_mean_defects_westeros[i]=mean(matrix_defects_westeros[,i], na.rm = TRUE)
  array_mean_defects_westeros[i]=array_mean_defects_westeros[i]+array_mean_defects_westeros[i-1]
}
array_mean_defects_westeros

```
```{r}
plot(array_mean_defects_harpy,type = "l", col = "red", xlab="month of usage", ylab = "percentage")
lines(array_mean_defects_westeros, type = "l", col ="blue")
```
Построение линейной регрессии для закупки партии мечей Harpy и Westeros:
```{r}
month<-c(1,2,3,4,5,6,7)
forecast_harpy <- lm(array_mean_defects_harpy~month)
forecast_harpy_for_1_18_month <- array(0,18)
for(i in 1:18)
forecast_harpy_for_1_18_month[i]=min(forecast_harpy$coefficients[1]+forecast_harpy$coefficients[2]*i,1)
  
forecast_westeros <- lm(array_mean_defects_westeros~month)
forecast_westeros_for_1_18_month <- array(0,18)
for(i in 1:18)
forecast_westeros_for_1_18_month[i]=min(forecast_westeros$coefficients[1]+forecast_westeros$coefficients[2]*i,1)

plot(forecast_harpy_for_1_18_month,type = "l", col = "red", xlab="month of usage", ylab = "percentage")
lines(forecast_westeros_for_1_18_month, type = "l", col = "blue")
lines(array_mean_defects_harpy, type = "p", col = "red")
lines(array_mean_defects_westeros, type = "p", col = "blue")
```
Сумма сломанного оружия по месяцам компании Harpy
```{r}
sum_defects_harpy <- c(0,0,0,0,0,0)
k = 1
for (i in 1:6){
  while ( data$supplier[k] == "harpy.co"){
    if (data$report.date[k] == i){
      sum_defects_harpy[i] = sum_defects_harpy[i] + data$defects[k]}
    k= k +1
  }
  k = 1
}
sum_defects_harpy

```
Сумма сломанного оружия по месяцам компании  Westeros
```{r}
sum_defects_westeros <- c(0,0,0,0,0,0)
k = 1352
for (i in 1:6){
  while ( k<=2700){
    if (data$report.date[k] == i){
      sum_defects_westeros[i] = sum_defects_westeros[i] + data$defects[k]}
    k= k +1
  }
  k = 1352
}
sum_defects_westeros
```
Построение boxplot для поиска лучшей компании
```{r}
delta_harpy = sum_produced_harpy - sum_defects_harpy
delta_westeros = sum_produced_westeros - sum_defects_westeros

companies <- c("harpy.co", "harpy.co", "harpy.co", "harpy.co", "harpy.co", "harpy.co", "westeros.inc", "westeros.inc", "westeros.inc", "westeros.inc", "westeros.inc", "westeros.inc")

delta_produced<-c(delta_harpy, delta_westeros)

boxplot(delta_produced ~ companies, col =c(2,3))

```
